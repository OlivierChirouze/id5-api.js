/**
 * id5-api.js - The ID5 API is designed to make accessing the ID5 Universal ID simple for publishers and their ad tech vendors. The ID5 Universal ID is a shared, neutral identifier that publishers and ad tech platforms can use to recognise users even in environments where 3rd party cookies are not available. For more information, visit https://id5.io/universal-id.
 * @version v0.9.0-pre
 * @link https://id5.io/
 * @license Apache-2.0
 */
!function(t){var o={};function r(n){if(o[n])return o[n].exports;var e=o[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=t,r.c=o,r.d=function(n,e,t){r.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:t})},r.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(e,"a",e),e},r.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},r.p="",r(r.s=2)}([function(n,e,t){"use strict";function o(n){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}t.d(e,"a",function(){return c});var r=t(1);var a,i,c=(i={debug:"Boolean",allowID5WithoutConsentApi:"Boolean",cmpApi:"String",consentData:"Object",cookieName:"String",refreshInSeconds:"Number",cookieExpirationInSeconds:"Number",partnerId:"Number",partnerUserId:"String",pd:"Object"},s(),{getConfig:function(){return a},setConfig:function(e){if("object"===o(e))return Object.keys(e).forEach(function(n){r.isA(e[n],i[n])?a[n]=e[n]:r.logError("setConfig options ".concat(n," must be of type ").concat(i[n]," but was ").concat(toString.call(e[n])))}),a;r.logError("setConfig options must be an object")},resetConfig:s});function s(){a={debug:"TRUE"===r.getParameterByName("id5_debug").toUpperCase(),allowID5WithoutConsentApi:!1,cmpApi:"iab",consentData:{getConsentData:{consentData:void 0,gdprApplies:void 0},getVendorConsents:{}},cookieName:"id5.1st",refreshInSeconds:7200,cookieExpirationInSeconds:7776e3,partnerId:void 0,partnerUserId:void 0,pd:{}}}},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.d(e,"bind",function(){return C}),e.replaceTokenInString=function(r,n,a){return x(n,function(n,e){n=void 0===n?"":n;var t=a+e.toUpperCase()+a,o=new RegExp(t,"g");r=r.replace(o,n)}),r},e.logMessage=w,e.logInfo=function(){S()&&y&&console.info.apply(console,k(arguments,"INFO:"))},e.logWarn=function(){S()&&v&&console.warn.apply(console,k(arguments,"WARNING:"))},e.logError=D,e.debugTurnedOn=S,e.getParameterByName=function(n){var e=new RegExp("[\\?&]"+n+"=([^&#]*)").exec(window.location.search);return null!==e?decodeURIComponent(e[1].replace(/\+/g," ")):""},e.isA=A,e.isFn=O,e.isStr=j,e.isArray=E,e.isNumber=function(n){return A(n,f)},e.isPlainObject=function(n){return A(n,p)},e.isBoolean=function(n){return A(n,d)},e.isEmpty=_,e._each=x,e._map=function(t,o){if(_(t))return[];if(O(t.map))return t.map(o);var r=[];return x(t,function(n,e){r.push(o(n,e,t))}),r},e.isSafariBrowser=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},e.checkCookieSupport=function(){if(window.navigator.cookieEnabled||document.cookie.length)return!0},e.cookiesAreEnabled=function(){return window.document.cookie="id5.cookieTest",-1!==window.document.cookie.indexOf("id5.cookieTest")},e.getCookie=function(n){var e=window.document.cookie.match("(^|;)\\s*"+n+"\\s*=\\s*([^;]*)\\s*(;|$)");return e?decodeURIComponent(e[2]):null},e.setCookie=function(n,e,t){document.cookie="".concat(n,"=").concat(encodeURIComponent(e)).concat(""!==t?"; expires=".concat(t):"","; path=/")},e.parseQS=T,e.formatQS=U,e.parse=N,e.format=R,e.ajax=function(n,e,t){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};try{var r,a=o.method||(t?"POST":"GET");document.createElement("a").href=n;var i="object"===u(e)&&null!==e?e:{success:function(){w("xhr success")},error:function(n){D("xhr error",null,n)}};if("function"==typeof e&&(i.success=e),(r=new window.XMLHttpRequest).onreadystatechange=function(){if(r.readyState===P){var n=r.status;200<=n&&n<300||304===n?i.success(r.responseText,r):i.error(r.statusText,r)}},r.ontimeout=function(){D("  xhr timeout after ",r.timeout,"ms")},"GET"===a&&t){var c=N(n,o);s(c.search,t),n=R(c)}r.open(a,n,!0),o.withCredentials&&(r.withCredentials=!0),x(o.customHeaders,function(n,e){r.setRequestHeader(e,n)}),o.preflight&&r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Content-Type",o.contentType||"text/plain"),"POST"===a&&t?r.send(t):r.send()}catch(n){D("xhr construction",n)}};var o=t(0);function s(){return(s=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])}return n}).apply(this,arguments)}function u(n){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function a(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(n)))return;var t=[],o=!0,r=!1,a=void 0;try{for(var i,c=n[Symbol.iterator]();!(o=(i=c.next()).done)&&(t.push(i.value),!e||t.length!==e);o=!0);}catch(n){r=!0,a=n}finally{try{o||null==c.return||c.return()}finally{if(r)throw a}}return t}(n,e)||function(n,e){if(!n)return;if("string"==typeof n)return r(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);"Object"===t&&n.constructor&&(t=n.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return r(n,e)}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=n[t];return o}var i="Array",c="String",l="Function",f="Number",p="Object",d="Boolean",g=Object.prototype.toString,h=Boolean(window.console),m=Boolean(h&&window.console.log),y=Boolean(h&&window.console.info),v=Boolean(h&&window.console.warn),b=Boolean(h&&window.console.error),I={},C=function(n,e){return e}.bind(null,1,I)()===I?Function.prototype.bind:function(n){var e=this,t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(n,t.concat(Array.prototype.slice.call(arguments)))}};function w(){S()&&m&&console.log.apply(console,k(arguments,"MESSAGE:"))}function D(){S()&&b&&console.error.apply(console,k(arguments,"ERROR:"))}function k(n,e){return n=[].slice.call(n),e&&n.unshift(e),n}function S(){return o.a.getConfig().debug}function A(n,e){return g.call(n)==="[object "+e+"]"}function O(n){return A(n,l)}function j(n){return A(n,c)}function E(n){return A(n,i)}function _(n){if(!n)return!0;if(E(n)||j(n))return!(0<n.length);for(var e in n)if(hasOwnProperty.call(n,e))return!1;return!0}function x(n,e){if(!_(n)){if(O(n.forEach))return n.forEach(e,this);var t=0,o=n.length;if(0<o)for(;t<o;t++)e(n[t],t,n);else for(t in n)hasOwnProperty.call(n,t)&&e.call(this,n[t],t)}}function T(n){return n?n.replace(/^\?/,"").split("&").reduce(function(n,e){var t=a(e.split("="),2),o=t[0],r=t[1];return/\[\]$/.test(o)?(n[o=o.replace("[]","")]=n[o]||[],n[o].push(r)):n[o]=r||"",n},{}):{}}function U(n){return Object.keys(n).map(function(e){return Array.isArray(n[e])?n[e].map(function(n){return"".concat(e,"[]=").concat(n)}).join("&"):"".concat(e,"=").concat(n[e])}).join("&")}function N(n,e){var t=document.createElement("a");e&&"noDecodeWholeURL"in e&&e.noDecodeWholeURL?t.href=n:t.href=decodeURIComponent(n);var o=e&&"decodeSearchAsString"in e&&e.decodeSearchAsString;return{href:t.href,protocol:(t.protocol||"").replace(/:$/,""),hostname:t.hostname,port:+t.port,pathname:t.pathname.replace(/^(?!\/)/,"/"),search:o?t.search:T(t.search||""),hash:(t.hash||"").replace(/^#/,""),host:t.host||window.location.host}}function R(n){return(n.protocol||"http")+"://"+(n.host||n.hostname+(n.port?":".concat(n.port):""))+(n.pathname||"")+(n.search?"?".concat(U(n.search||"")):"")+(n.hash?"#".concat(n.hash):"")}var P=4},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.d(e,"ID5",function(){return g});var o=t(3),r=t(0),p=t(1),d=t(4),a=t(5),g=Object(o.a)();g.loaded=!0,g.initialized=!1,g.init=function(n){try{p.logInfo("Invoking ID5.init",arguments);var c=r.a.setConfig(n);g.userConfig=n,g.config=c,g.initialized=!0;var o=Object(a.a)();p.logInfo("ID5 detected referer is ".concat(o.referer));var s=JSON.parse(p.getCookie(c.cookieName)),e=new Date(+p.getCookie("".concat(c.cookieName,"_last"))),u=0<e.getTime()&&Date.now()-e.getTime()>1e3*c.refreshInSeconds,l=new Date(Date.now()+1e3*c.cookieExpirationInSeconds).toUTCString(),t=p.getCookie("".concat(c.cookieName,"_nb")),f=t?parseInt(t)+1:1;p.setCookie("".concat(c.cookieName,"_nb"),f,l),s?(s.ID5ID?g.userId=s.ID5ID:s.universal_uid&&(g.userId=s.universal_uid,g.linkType=s.link_type||0),p.logInfo("ID5 User ID already available:",s,e,u)):p.logInfo("No ID5 User ID available"),d.b(function(n){if(d.a()){if(p.logInfo("Consent to access local storage and cookies is given"),!s||!s.universal_uid||!s.signature||u){var r=n&&n.gdprApplies?1:0,a=n&&n.gdprApplies?n.consentString:"",e="https://id5-sync.com/g/v2/".concat(c.partnerId,".json?gdpr_consent=").concat(a,"&gdpr=").concat(r),t=s&&s.signature?s.signature:"",i={"1puid":s&&s.ID5ID?s.ID5ID:"",v:g.version||"",o:"api",rf:o.referer,u:o.stack[0]||window.location.href,top:o.reachedTop?1:0,s:t,pd:c.pd||{},nb:f||1};p.logInfo("Fetching ID5 user ID from:",e,i),p.ajax(e,function(n){var e;if(n)try{if((e=JSON.parse(n)).universal_uid){if(g.userId=e.universal_uid,p.setCookie(c.cookieName,n,l),p.setCookie("".concat(c.cookieName,"_last"),Date.now(),l),p.setCookie("".concat(c.cookieName,"_nb"),0,l),e.cascade_needed){var t=c.partnerUserId&&0<c.partnerUserId.length,o="https://id5-sync.com/".concat(t?"s":"i","/").concat(c.partnerId,"/8.gif");p.logInfo("Opportunities to cascade available:",o,i),p.ajax(o,function(){},{puid:t?c.partnerUserId:null,gdpr:r,gdpr_consent:a},{method:"GET",withCredentials:!0})}}else p.logError("Invalid response from ID5 servers:",n)}catch(n){p.logError(n)}},JSON.stringify(i),{method:"POST",withCredentials:!0})}}else p.logInfo("No legal basis to use ID5",n)})}catch(n){p.logError("Exception catch",n)}},e.default=g},function(n,e,t){"use strict";e.a=function(){return window.ID5},window.ID5=window.ID5||{}},function(n,e,t){"use strict";e.b=function(n){var e=i.a.getConfig();e.allowID5WithoutConsentApi?(a.logError("ID5 is operating in forced consent mode"),n(o)):c[e.cmpApi]?o?n(o):("static"===e.cmpApi&&(a.isPlainObject(i.a.getConfig().consentData)?r=i.a.getConfig().consentData:a.logError("cmpApi: 'static' did not specify consentData.")),c[e.cmpApi].call(this,s,n)):(a.logError("Unknown consent API: ".concat(e.cmpApi)),u(),n(o))},e.a=function(){return!!i.a.getConfig().allowID5WithoutConsentApi||!!o&&("boolean"!=typeof o.gdprApplies||!o.gdprApplies||!!o.consentString&&(!o.vendorData||!o.vendorData.purposeConsents||!1!==o.vendorData.purposeConsents[1]))};var o,r,a=t(1),i=t(0),c={iab:function(n,o){var e,t=function(){var e={};function t(){e.getConsentData&&e.getVendorConsents&&n(e,o)}return{consentDataCallback:function(n){a.logInfo("cmpApi: consentDataCallback"),e.getConsentData=n,t()},vendorConsentsCallback:function(n){a.logInfo("cmpApi: vendorConsentsCallback"),e.getVendorConsents=n,t()}}}();try{e=window.__cmp||window.top.__cmp}catch(n){}a.isFn(e)?(a.logInfo("cmpApi: calling getConsentData & getVendorConsents"),e("getConsentData",null,t.consentDataCallback),e("getVendorConsents",null,t.vendorConsentsCallback)):n(void 0,o)},static:function(n,e){n(r,e)}};function s(n,e){var t=n&&n.getConsentData&&n.getConsentData.gdprApplies;"boolean"==typeof t&&(!0!==t||a.isStr(n.getConsentData.consentData)&&a.isPlainObject(n.getVendorConsents)&&1<Object.keys(n.getVendorConsents).length)?o={consentString:n?n.getConsentData.consentData:void 0,vendorData:n?n.getVendorConsents:void 0,gdprApplies:n?n.getConsentData.gdprApplies:void 0}:(u(),a.logError("CMP returned unexpected value during lookup process.",n)),e(o)}function u(){o=void 0}},function(n,e,t){"use strict";function r(){return(r=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])}return n}).apply(this,arguments)}t.d(e,"a",function(){return o});var a,o=(a=window,function(){try{var n,e=i(),t=e.length-1,o=null!==e[t].location||0<t&&null!==e[t-1].referrer,r=function(n){var e,t=[],o=null,r=null,a=null,i=null,c=null;for(e=n.length-1;0<=e;e--){try{o=n[e].location}catch(n){}if(o)t.push(o),c=c||o;else if(0!==e){r=n[e-1];try{a=r.referrer,i=r.ancestor}catch(n){}a?(t.push(a),c=c||a):i?(t.push(i),c=c||i):t.push(null)}else t.push(null)}return{stack:t,detectedRefererUrl:c}}(e);return e[e.length-1].canonicalUrl&&(n=e[e.length-1].canonicalUrl),{referer:r.detectedRefererUrl,reachedTop:o,numIframes:t,stack:r.stack,canonicalUrl:n}}catch(n){}});function i(){var n=function(){var e,t=[];do{try{e=e?e.parent:a;try{var n=e===a.top,o={referrer:e.document.referrer||null,location:e.location.href||null,isTop:n};n&&(o=r(o,{canonicalUrl:c(e.document)})),t.push(o)}catch(n){t.push({referrer:null,location:null,isTop:e===a.top})}}catch(n){return t.push({referrer:null,location:null,isTop:!1}),t}}while(e!==a.top);return t}(),e=function(){try{if(!a.location.ancestorOrigins)return;return a.location.ancestorOrigins}catch(n){}}();if(e)for(var t=0,o=e.length;t<o;t++)n[t].ancestor=e[t];return n}function c(n){try{var e=n.querySelector("link[rel='canonical']");if(null!==e)return e.href}catch(n){}return null}}]),ID5.version="0.9.0-pre";