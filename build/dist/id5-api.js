/**
 * id5-api.js - The ID5 API is designed to make accessing the ID5 Universal ID simple for publishers and their ad tech vendors. The ID5 Universal ID is a shared, neutral identifier that publishers and ad tech platforms can use to recognise users even in environments where 3rd party cookies are not available. For more information, visit https://id5.io/universal-id.
 * @version v0.9.2
 * @link https://id5.io/
 * @license Apache-2.0
 */
!function(t){var o={};function r(n){if(o[n])return o[n].exports;var e=o[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=t,r.c=o,r.d=function(n,e,t){r.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:t})},r.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(e,"a",e),e},r.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},r.p="",r(r.s=2)}([function(n,e,t){"use strict";function o(n){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}t.d(e,"a",function(){return c});var r=t(1);var i,a,c=(a={debug:"Boolean",allowID5WithoutConsentApi:"Boolean",cmpApi:"String",consentData:"Object",cookieName:"String",refreshInSeconds:"Number",cookieExpirationInSeconds:"Number",partnerId:"Number",partnerUserId:"String",pd:"String"},s(),{getConfig:function(){return i},setConfig:function(e){if("object"===o(e))return Object.keys(e).forEach(function(n){r.isA(e[n],a[n])?i[n]=e[n]:r.logError("setConfig options ".concat(n," must be of type ").concat(a[n]," but was ").concat(toString.call(e[n])))}),i;r.logError("setConfig options must be an object")},resetConfig:s});function s(){i={debug:"TRUE"===r.getParameterByName("id5_debug").toUpperCase(),allowID5WithoutConsentApi:!1,cmpApi:"iab",consentData:{getConsentData:{consentData:void 0,gdprApplies:void 0},getVendorConsents:{}},cookieName:"id5.1st",refreshInSeconds:7200,cookieExpirationInSeconds:7776e3,partnerId:void 0,partnerUserId:void 0,pd:""}}},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.d(e,"bind",function(){return w}),e.replaceTokenInString=function(r,n,i){return U(n,function(n,e){n=void 0===n?"":n;var t=i+e.toUpperCase()+i,o=new RegExp(t,"g");r=r.replace(o,n)}),r},e.logMessage=C,e.logInfo=function(){k()&&y&&console.info.apply(console,S(arguments,"INFO:"))},e.logWarn=function(){k()&&v&&console.warn.apply(console,S(arguments,"WARNING:"))},e.logError=D,e.debugTurnedOn=k,e.getParameterByName=function(n){var e=new RegExp("[\\?&]"+n+"=([^&#]*)").exec(window.location.search);return null!==e?decodeURIComponent(e[1].replace(/\+/g," ")):""},e.isA=A,e.isFn=O,e.isStr=j,e.isArray=E,e.isNumber=function(n){return A(n,f)},e.isPlainObject=function(n){return A(n,p)},e.isBoolean=function(n){return A(n,d)},e.isEmpty=x,e._each=U,e._map=function(t,o){if(x(t))return[];if(O(t.map))return t.map(o);var r=[];return U(t,function(n,e){r.push(o(n,e,t))}),r},e.isSafariBrowser=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},e.checkCookieSupport=function(){if(window.navigator.cookieEnabled||document.cookie.length)return!0},e.cookiesAreEnabled=function(){return window.document.cookie="id5.cookieTest",-1!==window.document.cookie.indexOf("id5.cookieTest")},e.getCookie=function(n){var e=window.document.cookie.match("(^|;)\\s*"+n+"\\s*=\\s*([^;]*)\\s*(;|$)");return e?decodeURIComponent(e[2]):null},e.setCookie=function(n,e,t){document.cookie="".concat(n,"=").concat(encodeURIComponent(e)).concat(""!==t?"; expires=".concat(t):"","; path=/")},e.parseQS=T,e.formatQS=_,e.parse=N,e.format=R,e.ajax=function(n,e,t){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};try{var r,i=o.method||(t?"POST":"GET");document.createElement("a").href=n;var a="object"===u(e)&&null!==e?e:{success:function(){C("xhr success")},error:function(n){D("xhr error",null,n)}};if("function"==typeof e&&(a.success=e),(r=new window.XMLHttpRequest).onreadystatechange=function(){if(r.readyState===P){var n=r.status;200<=n&&n<300||304===n?a.success(r.responseText,r):a.error(r.statusText,r)}},r.ontimeout=function(){D("  xhr timeout after ",r.timeout,"ms")},"GET"===i&&t){var c=N(n,o);s(c.search,t),n=R(c)}r.open(i,n,!0),o.withCredentials&&(r.withCredentials=!0),U(o.customHeaders,function(n,e){r.setRequestHeader(e,n)}),o.preflight&&r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Content-Type",o.contentType||"text/plain"),"POST"===i&&t?r.send(t):r.send()}catch(n){D("xhr construction",n)}};var o=t(0);function s(){return(s=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])}return n}).apply(this,arguments)}function u(n){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function i(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(n)))return;var t=[],o=!0,r=!1,i=void 0;try{for(var a,c=n[Symbol.iterator]();!(o=(a=c.next()).done)&&(t.push(a.value),!e||t.length!==e);o=!0);}catch(n){r=!0,i=n}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return t}(n,e)||function(n,e){if(!n)return;if("string"==typeof n)return r(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);"Object"===t&&n.constructor&&(t=n.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return r(n,e)}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=n[t];return o}var a="Array",c="String",l="Function",f="Number",p="Object",d="Boolean",g=Object.prototype.toString,h=Boolean(window.console),m=Boolean(h&&window.console.log),y=Boolean(h&&window.console.info),v=Boolean(h&&window.console.warn),b=Boolean(h&&window.console.error),I={},w=function(n,e){return e}.bind(null,1,I)()===I?Function.prototype.bind:function(n){var e=this,t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(n,t.concat(Array.prototype.slice.call(arguments)))}};function C(){k()&&m&&console.log.apply(console,S(arguments,"MESSAGE:"))}function D(){k()&&b&&console.error.apply(console,S(arguments,"ERROR:"))}function S(n,e){return n=[].slice.call(n),e&&n.unshift(e),n}function k(){return o.a.getConfig().debug}function A(n,e){return g.call(n)==="[object "+e+"]"}function O(n){return A(n,l)}function j(n){return A(n,c)}function E(n){return A(n,a)}function x(n){if(!n)return!0;if(E(n)||j(n))return!(0<n.length);for(var e in n)if(hasOwnProperty.call(n,e))return!1;return!0}function U(n,e){if(!x(n)){if(O(n.forEach))return n.forEach(e,this);var t=0,o=n.length;if(0<o)for(;t<o;t++)e(n[t],t,n);else for(t in n)hasOwnProperty.call(n,t)&&e.call(this,n[t],t)}}function T(n){return n?n.replace(/^\?/,"").split("&").reduce(function(n,e){var t=i(e.split("="),2),o=t[0],r=t[1];return/\[\]$/.test(o)?(n[o=o.replace("[]","")]=n[o]||[],n[o].push(r)):n[o]=r||"",n},{}):{}}function _(n){return Object.keys(n).map(function(e){return Array.isArray(n[e])?n[e].map(function(n){return"".concat(e,"[]=").concat(n)}).join("&"):"".concat(e,"=").concat(n[e])}).join("&")}function N(n,e){var t=document.createElement("a");e&&"noDecodeWholeURL"in e&&e.noDecodeWholeURL?t.href=n:t.href=decodeURIComponent(n);var o=e&&"decodeSearchAsString"in e&&e.decodeSearchAsString;return{href:t.href,protocol:(t.protocol||"").replace(/:$/,""),hostname:t.hostname,port:+t.port,pathname:t.pathname.replace(/^(?!\/)/,"/"),search:o?t.search:T(t.search||""),hash:(t.hash||"").replace(/^#/,""),host:t.host||window.location.host}}function R(n){return(n.protocol||"http")+"://"+(n.host||n.hostname+(n.port?":".concat(n.port):""))+(n.pathname||"")+(n.search?"?".concat(_(n.search||"")):"")+(n.hash?"#".concat(n.hash):"")}var P=4},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.d(e,"ID5",function(){return m});var o=t(3),r=t(0),g=t(1),h=t(4),i=t(5),m=Object(o.a)();function y(n){return"".concat(n.cookieName,"_last")}function v(n){return"".concat(n.cookieName,"_nb")}m.loaded=!0,m.initialized=!1,m.init=function(n){if(void 0===m.version)throw new Error('ID5.version variable is missing! Make sure you build from source with "gulp build" from this project. Contact support@id5.io for help.');try{g.logInfo("Invoking ID5.init",arguments);var c=r.a.setConfig(n);m.userConfig=n,m.config=c,m.initialized=!0,m.getConfig=r.a.getConfig;var s=Object(i.a)();if(g.logInfo("ID5 detected referer is ".concat(s.referer)),"number"!=typeof c.partnerId)throw new Error("partnerId is required and must be a number");var u=JSON.parse(g.getCookie(c.cookieName)),e=new Date(+g.getCookie(y(c))).getTime(),l=e<=0||Date.now()-e>1e3*c.refreshInSeconds,f=new Date(Date.now()+1e3*c.cookieExpirationInSeconds).toUTCString(),p=function(n){var e=g.getCookie(v(n));return e?parseInt(e):0}(c),d=!1;u?(u.ID5ID?m.userId=u.ID5ID:u.universal_uid&&(m.userId=u.universal_uid,m.linkType=u.link_type||0),p=function(n,e,t){return t++,g.setCookie(v(n),t,e),t}(c,f,p),d=!0,g.logInfo("ID5 User ID available from cache:",u,e,l)):g.logInfo("No ID5 User ID available"),h.b(function(n){if(h.a()){if(g.logInfo("Consent to access local storage and cookies is given"),!u||!u.universal_uid||!u.signature||l){var r=n&&n.gdprApplies?1:0,i=n&&n.gdprApplies?n.consentString:"",e="https://id5-sync.com/g/v2/".concat(c.partnerId,".json?gdpr_consent=").concat(i,"&gdpr=").concat(r),t=u&&u.signature?u.signature:"",o=u&&u.ID5ID?u.ID5ID:"",a={partner:c.partnerId,"1puid":o,v:m.version,o:"api",rf:s.referer,u:s.stack[0]||window.location.href,top:s.reachedTop?1:0,s:t,pd:c.pd||"",nbPage:p};g.logInfo("Fetching ID5 user ID from:",e,a),g.ajax(e,function(n){var e;if(n)try{if((e=JSON.parse(n)).universal_uid){if(m.userId=e.universal_uid,g.setCookie(c.cookieName,n,f),g.setCookie(y(c),Date.now(),f),g.setCookie(v(c),d?0:1,f),e.cascade_needed){var t=c.partnerUserId&&0<c.partnerUserId.length,o="https://id5-sync.com/".concat(t?"s":"i","/").concat(c.partnerId,"/8.gif");g.logInfo("Opportunities to cascade available:",o,a),g.ajax(o,function(){},{puid:t?c.partnerUserId:null,gdpr:r,gdpr_consent:i},{method:"GET",withCredentials:!0})}}else g.logError("Invalid response from ID5 servers:",n)}catch(n){g.logError(n)}},JSON.stringify(a),{method:"POST",withCredentials:!0})}}else g.logInfo("No legal basis to use ID5",n)})}catch(n){g.logError("Exception catch",n)}},e.default=m},function(n,e,t){"use strict";e.a=function(){return window.ID5},window.ID5=window.ID5||{}},function(n,e,t){"use strict";e.b=function(n){var e=a.a.getConfig();e.allowID5WithoutConsentApi?(i.logError("ID5 is operating in forced consent mode"),n(o)):c[e.cmpApi]?o?n(o):("static"===e.cmpApi&&(i.isPlainObject(a.a.getConfig().consentData)?r=a.a.getConfig().consentData:i.logError("cmpApi: 'static' did not specify consentData.")),c[e.cmpApi].call(this,s,n)):(i.logError("Unknown consent API: ".concat(e.cmpApi)),u(),n(o))},e.a=function(){return!!a.a.getConfig().allowID5WithoutConsentApi||!!o&&("boolean"!=typeof o.gdprApplies||!o.gdprApplies||!!o.consentString&&(!o.vendorData||!o.vendorData.purposeConsents||!1!==o.vendorData.purposeConsents[1]))};var o,r,i=t(1),a=t(0),c={iab:function(n,o){var e,t=function(){var e={};function t(){e.getConsentData&&e.getVendorConsents&&n(e,o)}return{consentDataCallback:function(n){i.logInfo("cmpApi: consentDataCallback"),e.getConsentData=n,t()},vendorConsentsCallback:function(n){i.logInfo("cmpApi: vendorConsentsCallback"),e.getVendorConsents=n,t()}}}();try{e=window.__cmp||window.top.__cmp}catch(n){}i.isFn(e)?(i.logInfo("cmpApi: calling getConsentData & getVendorConsents"),e("getConsentData",null,t.consentDataCallback),e("getVendorConsents",null,t.vendorConsentsCallback)):n(void 0,o)},static:function(n,e){n(r,e)}};function s(n,e){var t=n&&n.getConsentData&&n.getConsentData.gdprApplies;"boolean"==typeof t&&(!0!==t||i.isStr(n.getConsentData.consentData)&&i.isPlainObject(n.getVendorConsents)&&1<Object.keys(n.getVendorConsents).length)?o={consentString:n?n.getConsentData.consentData:void 0,vendorData:n?n.getVendorConsents:void 0,gdprApplies:n?n.getConsentData.gdprApplies:void 0}:(u(),i.logError("CMP returned unexpected value during lookup process.",n)),e(o)}function u(){o=void 0}},function(n,e,t){"use strict";function r(){return(r=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])}return n}).apply(this,arguments)}t.d(e,"a",function(){return o});var i,o=(i=window,function(){try{var n,e=a(),t=e.length-1,o=null!==e[t].location||0<t&&null!==e[t-1].referrer,r=function(n){var e,t=[],o=null,r=null,i=null,a=null,c=null;for(e=n.length-1;0<=e;e--){try{o=n[e].location}catch(n){}if(o)t.push(o),c=c||o;else if(0!==e){r=n[e-1];try{i=r.referrer,a=r.ancestor}catch(n){}i?(t.push(i),c=c||i):a?(t.push(a),c=c||a):t.push(null)}else t.push(null)}return{stack:t,detectedRefererUrl:c}}(e);return e[e.length-1].canonicalUrl&&(n=e[e.length-1].canonicalUrl),{referer:r.detectedRefererUrl,reachedTop:o,numIframes:t,stack:r.stack,canonicalUrl:n}}catch(n){}});function a(){var n=function(){var e,t=[];do{try{e=e?e.parent:i;try{var n=e===i.top,o={referrer:e.document.referrer||null,location:e.location.href||null,isTop:n};n&&(o=r(o,{canonicalUrl:c(e.document)})),t.push(o)}catch(n){t.push({referrer:null,location:null,isTop:e===i.top})}}catch(n){return t.push({referrer:null,location:null,isTop:!1}),t}}while(e!==i.top);return t}(),e=function(){try{if(!i.location.ancestorOrigins)return;return i.location.ancestorOrigins}catch(n){}}();if(e)for(var t=0,o=e.length;t<o;t++)n[t].ancestor=e[t];return n}function c(n){try{var e=n.querySelector("link[rel='canonical']");if(null!==e)return e.href}catch(n){}return null}}]),ID5.version="0.9.2";